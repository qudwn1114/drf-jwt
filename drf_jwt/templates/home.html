<h1>Main Page</h1>
<div id="auth_div">
    {% if user %}
        <button onclick="logout()">logout</button>
    {% else %}
        <button onclick="location.href='/login'">login</button>
    {% endif %}
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js" crossorigin="anonymous"></script>
<script src="/static/js/jwt.js"></script>
<script>
    let auth = authentication();

    function logout(){
        let access_token = getCookie("access_token");
        let refresh_token_index_id = getCookie("refresh_token_index_id");
        $.ajax({
            type: "POST",
            url: "/api/logout/",
            headers: {
                'Authorization': `Bearer ${access_token}`,
            },
            data: {
                "refresh_token_index_id" : refresh_token_index_id
            },
            datatype: "JSON",
            async: false,
            success: function(data) {
                resetToken();
                location.reload();
            },
            error: function(error) {
                console.log(error.responseJSON);
            },
        });
}
</script>
